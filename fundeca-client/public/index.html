<!DOCTYPE html>
<html lang="{{data.language}}">
<head>
    <title>Gateway</title>
</head>
<body>
<div class="container pull-left">
    <div class="row">

        <form action="" class="formTarjeta form_newcard" autocomplete="on" id="CardGatewayForm"
              method="post" accept-charset="utf-8">

            <div class="form-group col-xs-12">
                <input name="cardPan" autocorrect="off" autocapitalize="off"
                       autocomplete="cc-num" placeholder="0000 0000 0000 0000"
                       class="form-control cc-num" required="required" type="tel"
                       id="CardPNPCardPan"/>
            </div>

            <div class="form-group col-xs-12">
                <input name="cardExpireFull" autocorrect="off" autocapitalize="off"
                       autocomplete="cc-exp" placeholder="00/00"
                       class="form-control cc-exp" required="required" type="tel"
                       id="CardPNPCardExpireFull"/>
            </div>

            <div class="form-group col-xs-12">
                <input name="cvv2" autocorrect="off" autocapitalize="off"
                       autocomplete="off" placeholder="CVV" class="form-control cc-cvc"
                       required="required" type="tel" id="CardPNPCVV2"/>
            </div>
        </form>
    </div>
</div>

<script src="/js/v1-card-iframe.js"></script>
<script src="https://paylands-web-assets.s3-eu-west-1.amazonaws.com/js/v1-device.js"></script>
<script src="https://paylands-web-assets.s3.eu-west-1.amazonaws.com/js/translations.js"></script>
<script type="text/javascript">
    $(document).ready(function () {
        var tplLanguage = "{{data.language}}";

        if(translations[tplLanguage] === undefined) {
            var currentTranslations = translations['es'];
        } else {
            var currentTranslations = translations[tplLanguage];
        }

        // $('input.cc-num').payment('formatCardNumber');
        // $('input.cc-exp').payment('formatCardExpiry');
        // $('input.cc-cvc').payment('formatCardCVC');

        // $(document).on('blur', 'input.cc-num', function () {
        //     if ($('input.cc-num').val().length == 0)
        //         $(".ccType").hide();
        // });

        $('form.form_newcard').on('submit', function (e) {

            var cardType = $.payment.cardType($('.cc-num').val());

            if (!$.payment.validateCardNumber($('.cc-num').val())) {
                e.preventDefault();
                alert(currentTranslations.alert_invalid_card);
                return false;
            }

            if (!$.payment.validateCardExpiry($('.cc-exp').payment('cardExpiryVal'))) {
                e.preventDefault();
                alert(currentTranslations.alert_invalid_expiry);
                return false;
            }

            if (!$.payment.validateCardCVC($('.cc-cvc').val(), cardType)) {
                e.preventDefault();
                alert(currentTranslations.alert_invalid_cvv);
                return false;
            }
            return true;
        });
    });
</script>
</body>
</html>